
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installation &mdash; zendev 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-2.2.1.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-responsive-2.2.1.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-2.2.1.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="zendev 0.1.0 documentation" href="index.html" />
    <link rel="next" title="Working With Environments" href="environments.html" />
    <link rel="prev" title="zendev" href="readme.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>
<div class="container">
  
  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a class="brand" href="index.html">zendev</a>
      <span class="navbar-text pull-left"><b>0.1.0</b></span>

      <div class="nav-collapse">
        <ul class="nav">
          <li class="divider-vertical"></li>
          
            <li class="dropdown">
  <a href="index.html" class="dropdown-toggle" data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">zendev</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Working With Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="repos.html">Working With Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building Zenoss With zendev</a></li>
<li class="toctree-l1"><a class="reference internal" href="devimg.html">Developing Zenoss in the Control Plane</a></li>
<li class="toctree-l1"><a class="reference internal" href="pullrequest.html">Pull Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Running Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="port.html">Porting Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="vagrant.html">Working With Vagrant Boxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster.html">Vagrant Clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="packer.html">Building the Development Base Box</a></li>
<li class="toctree-l1"><a class="reference internal" href="improve.html">Improving zendev</a></li>
</ul>
</ul>
</li>
            <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Installation</a><ul>
<li><a class="reference internal" href="#ubuntu">Ubuntu</a></li>
<li><a class="reference internal" href="#os-x">OS X</a></li>
<li><a class="reference internal" href="#windows">Windows</a></li>
<li><a class="reference internal" href="#self-managed-vagrant-box">Self-managed Vagrant box</a></li>
<li><a class="reference internal" href="#update-zendev">Update zendev</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          
          
            
  <li><a href="readme.html"
         title="previous chapter">&laquo; zendev</a></li>
  <li><a href="environments.html"
         title="next chapter">Working With Environments &raquo;</a></li>
          
          
            <li>
  <a href="_sources/installation.txt"
     rel="nofollow">Source</a></li>
          
        </ul>

        
          
<form class="navbar-search pull-right" style="margin-bottom:-3px;" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        
      </div>
    </div>
  </div>

  
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<p>Other things being equal, Zenoss development as a whole is easiest on Ubuntu.
That said, zendev can work on any platform that isn&#8217;t Windows, and includes an
Ubuntu Vagrant box already set up with the proper dependencies.</p>
<p>Here&#8217;s how to set up a full Zenoss development environment on Ubuntu (in case
you were wondering, these instructions go far beyond the requirements for
zendev itself, which are basically git and Python).</p>
<p><strong>Note</strong>: In the rare case that you are installing on a box that previously had
a non-zendev instance of Resource Manager, reinstall docker.
Specifically, you need to delete /etc/default/docker or revert the DOCKER_OPTS
setting to the initial &#8211;dns option. Just apt-get remove lxc-docker-1.5.0 and
reinstall it.</p>
<div class="section" id="ubuntu">
<h2>Ubuntu<a class="headerlink" href="#ubuntu" title="Permalink to this headline">¶</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Ubuntu 14.04 or higher is required.</p>
</div>
<ol class="arabic">
<li><p class="first">Make sure the universe and multiverse repos are enabled and updated:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Add the repository</span>
sudo add-apt-repository <span class="s2">&quot;deb http://archive.ubuntu.com/ubuntu </span><span class="k">$(</span>lsb_release -sc<span class="k">)</span><span class="s2"> main universe restricted multiverse&quot;</span>

<span class="c"># Update the repos</span>
sudo apt-get update
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Install <a class="reference external" href="http://docker.io/">Docker</a>:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Install dependencies</span>
sudo apt-get install -y curl nfs-kernel-server nfs-common net-tools

<span class="c"># ------------------------------------------------------------------</span>
<span class="c"># Install Docker for old Europa (version 1.0.x)</span>
<span class="c"># (Uses Docker 1.5)</span>
<span class="c"># ------------------------------------------------------------------</span>
sudo apt-get install apt-transport-https
sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 <span class="se">\</span>
    --recv-keys 36A1D7869245C8950F966E92D8576A8BA88D21E9
sudo sh -c <span class="s2">&quot;echo deb https://get.docker.com/ubuntu docker main \</span>
<span class="s2">    &gt; /etc/apt/sources.list.d/docker.list&quot;</span>
sudo apt-get update
sudo apt-get install lxc-docker-1.5.0

<span class="c"># ------------------------------------------------------------------</span>
<span class="c"># -OR-</span>
<span class="c"># Install Docker for all other cases, including current Europa work</span>
<span class="c"># (Uses the latest version of Docker)</span>
<span class="c"># ------------------------------------------------------------------</span>
sudo apt-get install apt-transport-https
sudo apt-key adv --keyserver hkp://pgp.mit.edu:80 <span class="se">\</span>
    --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
sudo sh -c <span class="s2">&quot;echo deb https://apt.dockerproject.org/repo ubuntu-</span><span class="k">$(</span>lsb_release -sc<span class="k">)</span><span class="s2"> main \</span>
<span class="s2">    &gt; /etc/apt/sources.list.d/docker.list&quot;</span>
sudo apt-get update
sudo apt-get purge lxc-docker*
sudo apt-get install docker-engine<span class="o">=</span>1.9.1-0~<span class="k">$(</span>lsb_release -sc<span class="k">)</span>

<span class="c"># Lock the version of Docker so updates won&#39;t bump it to a newer version</span>
sudo apt-mark hold docker-engine
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Create and configure devicemapper storage for Docker:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Install lvm tools</span>
sudo apt-get install lvm2 thin-provisioning-tools
</pre></div>
</div>
<p>The development machine you were provided should have a second hard drive
installed for extra storage.  Use that for an LVM thin pool.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Identify the partition you need to mount</span>
sudo lsblk -o NAME,FSTYPE,SIZE,MOUNTPOINT,UUID
</pre></div>
</div>
<p>You&#8217;ll be looking for an ext4 partition that hasn&#8217;t been mounted.  Take note of the device name (e.g., /dev/sda1)</p>
<p>Example output:</p>
<div class="highlight-bash"><div class="highlight"><pre> NAME                     FSTYPE        SIZE MOUNTPOINT      UUID
 sda                                  931.5G
<span class="hll"> └─sda1                   ext4        931.5G                 84ae6065-25fd-4f0a-9fba-40da962ada20
</span> sdb                                  238.5G
 ├─sdb1                   ext2          243M /boot           5a2e2cd4-9a5a-4874-90ba-4195d9400a37
 ├─sdb2                                   1K
 └─sdb5                   LVM2_member 238.2G                 yiLydV-Bh6u-X6vH-sLgS-Gjc0-94th-vv76KJ
   ├─it--vg-root <span class="o">(</span>dm-0<span class="o">)</span>   ext4        110.3G /               fcb63cf5-ce47-4cf3-a207-2caa2fad7f4f
   └─it--vg-swap_1 <span class="o">(</span>dm-1<span class="o">)</span> swap        127.9G <span class="o">[</span>SWAP<span class="o">]</span>          b30cf82e-46b4-461f-9f76-d475a8bf3859
 sr0                                   1024M
</pre></div>
</div>
<p>Set up the LVM thin pool</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Set up parameters for following commands</span>
<span class="c"># DEV_NAME is the name of the device on your system (e.g., /dev/sda1)</span>
<span class="c"># VOLUME_GROUP and THIN_POOL can be whatever you want, but these</span>
<span class="c"># are reasonable values.</span>
<span class="nv">DEV_NAME</span><span class="o">=</span>/dev/whatever
<span class="nv">VOLUME_GROUP</span><span class="o">=</span>docker
<span class="nv">THIN_POOL</span><span class="o">=</span>pool

<span class="c"># Create an LVM physical volume and volume group</span>
sudo vgcreate <span class="nv">$VOLUME_GROUP</span> <span class="nv">$DEV_NAME</span>

<span class="c"># Create an LVM thin pool logical volume</span>
sudo lvcreate -l98%FREE -T <span class="nv">$VOLUME_GROUP</span>/<span class="nv">$THIN_POOL</span>

<span class="c"># Note the devicemapper path for the thin pool.  This will be</span>
<span class="c"># referenced in the docker configuration.  It should be something</span>
<span class="c"># like /dev/mapper/docker-pool</span>
<span class="nv">LV_DMPATH</span><span class="o">=</span><span class="k">$(</span>sudo lvs -S <span class="nv">lv_attr</span><span class="o">=</span>~t.<span class="se">\*</span> -o lv_dmpath --noheadings <span class="nv">$VOLUME_GROUP</span> <span class="p">|</span> tr -d <span class="se">\ </span><span class="k">)</span>

<span class="c"># Depending on the version of lvm, the preceding command may fail.  If</span>
<span class="c"># it does, you will have to determine the devicemapper path manually.</span>
<span class="c"># Run the following command, and set LV_DMPATH to the filename appended</span>
<span class="c"># to /dev/mapper.  It should look like this /dev/mapper/docker-pool-tpool</span>
sudo dmsetup ls --target<span class="o">=</span>thin-pool
<span class="nv">LV_DMPATH</span><span class="o">=</span>/dev/mapper/docker-pool-tpool
</pre></div>
</div>
<p>Configure docker to use the thin pool</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Populate a docker environment file with devicemapper storage options and the</span>
<span class="c"># addresses of the zenoss DNS servers</span>
sudo sh -c <span class="s2">&quot;cat &gt;/etc/default/docker &lt;&lt; EOL</span>
<span class="s2">DOCKER_OPTS=\&quot;--storage-driver=devicemapper --storage-opt dm.thinpooldev=</span><span class="nv">$LV_DMPATH</span><span class="s2"> --dns 10.87.113.13 --dns 10.88.102.13\&quot;</span>
<span class="s2">DOCKER_TASKS_MAX=infinity</span>
<span class="s2">EOL&quot;</span>

<span class="c"># Add the environment file to the docker service</span>
sudo sed -i <span class="s1">&#39;s~\[Service\]~&amp;\nEnvironmentFile=/etc/default/docker~&#39;</span> /lib/systemd/system/docker.service

<span class="c"># Add DOCKER_OPTS to the docker startup command</span>
sudo sed -i <span class="s1">&#39;s~ExecStart.*$~&amp; $DOCKER_OPTS~&#39;</span> /lib/systemd/system/docker.service

<span class="c"># Use DOCKER_TASKS_MAX to set the tasks limit</span>
sudo sed -i <span class="s1">&#39;s~ExecStart.*~&amp;\nTasksMax=$DOCKER_TASKS_MAX~&#39;</span> /lib/systemd/system/docker.service

<span class="c"># Stop docker</span>
sudo systemctl stop docker

<span class="c"># Clean up existing docker storage</span>
sudo rm -rf /var/lib/docker

<span class="c"># Reload docker.service</span>
sudo systemctl daemon-reload

<span class="c"># Restart docker</span>
sudo systemctl start docker
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Time for Docker-related configuration.</p>
<blockquote>
<div><p>Add your user to the <tt class="docutils literal"><span class="pre">docker</span></tt> group:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Add the current user to the docker group</span>
sudo usermod -a -G docker <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>
sudo usermod -a -G sudo <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>    <span class="c"># if ubuntu</span>
sudo usermod -a -G wheel <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>   <span class="c"># if RHEL/Centos</span>

<span class="c"># Login again to get docker group (requires password reentry)</span>
<span class="nb">exec </span>su -l <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>

<span class="c"># Restart Docker</span>
sudo systemctl restart docker
</pre></div>
</div>
<p>Test that you can communicate with the docker daemon:</p>
<div class="highlight-bash"><div class="highlight"><pre>docker ps
</pre></div>
</div>
<p>If you see an empty list of containers (i.e., a row of column names), you&#8217;re good.</p>
<p>Next, modify <tt class="docutils literal"><span class="pre">/etc/security/limits.conf</span></tt> to up the file limits:</p>
<div class="highlight-bash"><div class="highlight"><pre>cat <span class="s">&lt;&lt;\EOF | sudo /bin/bash -c &quot;cat &gt;&gt; /etc/security/limits.conf&quot;</span>
<span class="s">*      hard   nofile   1048576</span>
<span class="s">*      soft   nofile   1048576</span>
<span class="s">root   hard   nofile   1048576</span>
<span class="s">root   soft   nofile   1048576</span>
<span class="s">EOF</span>
</pre></div>
</div>
<p>Then reboot, to make sure the new limits take effect.</p>
<p>Set up your hub.docker.com credentials.  Go to here: <a class="reference external" href="https://hub.docker.com/account/signup/">https://hub.docker.com/account/signup/</a>.  Send Ian an email with your Docker Hub username and real name.  Your credentials will be added to groups so you get access to our private repositories (Resource Manager, Impact, etc.).</p>
<p>When your box comes back up, authenticate to hub.docker.com:</p>
<div class="highlight-bash"><div class="highlight"><pre>docker login -u YOUR_DOCKERHUB_USERNAME -e <span class="s2">&quot;you@zenoss.com&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Install <a class="reference external" href="http://golang.org/">Go</a>:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Install &quot;go get&quot; dependencies</span>
sudo apt-get install -y mercurial bzr git

<span class="c"># Install the Go version we are using</span>
sudo apt-get install -y wget curl
curl -s https://storage.googleapis.com/golang/go1.6.linux-amd64.tar.gz <span class="p">|</span> sudo tar -xzC /usr/local

<span class="c"># Set GOROOT and PATH appropriately</span>
cat <span class="s">&lt;&lt;\EOF | sudo bash -c &quot;cat &gt; /etc/profile.d/golang.sh&quot;</span>
<span class="s">    export GOROOT=/usr/local/go</span>
<span class="s">    export PATH=$GOROOT/bin:$PATH</span>
<span class="s">EOF</span>

<span class="c"># Source the new profile</span>
<span class="nb">source</span> /etc/profile.d/golang.sh

<span class="c"># Add important/useful golang things</span>
<span class="nb">export </span><span class="nv">GOPATH</span><span class="o">=</span>/opt/go

sudo mkdir -p <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>/<span class="o">{</span>bin,pkg,src<span class="o">}</span>
sudo chown -R <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>:<span class="si">${</span><span class="nv">USER</span><span class="si">}</span> <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>

go get github.com/golang/lint/golint
sudo ln -s <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>/bin/golint /usr/local/bin/golint

go get -v github.com/rogpeppe/godef
go install -v github.com/rogpeppe/godef
sudo ln -s <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>/bin/godef /usr/local/bin/godef

go get -u github.com/nsf/gocode
sudo ln -s <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>/bin/gocode /usr/local/bin/gocode

go get golang.org/x/tools/cmd/goimports
sudo ln -s <span class="si">${</span><span class="nv">GOPATH</span><span class="si">}</span>/bin/goimports /usr/local/bin/goimports
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Install other dependencies:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Python, pip</span>
sudo apt-get install -y python-dev python-pip
sudo pip install --upgrade pip

<span class="c"># Python setup tools (package is named &#39;python-setuptools&#39; in &#39;dpkg&#39; output)</span>
<span class="c"># (We are running Python version 2.7.6)</span>
sudo pip install setuptools --no-use-wheel --upgrade

<span class="c"># libpam (necessary for control plane)</span>
sudo apt-get install -y libpam0g-dev

<span class="c"># serviced needs these for visualization - dirs are in ubuntu 12.04, but not 13.04</span>
sudo mkdir /sys/fs/cgroup/<span class="o">{</span>blkio,cpuacct,memory<span class="o">}</span>/lxc

<span class="c"># tmux or screen will make your life better</span>
sudo apt-get install -y tmux screen

<span class="c"># Additional packages needed to build</span>
sudo apt-get install -y xfsprogs xfsdump libdevmapper-dev

<span class="c"># Need Java to run some of the services (and the build tests)</span>
sudo apt-get install -y default-jdk
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">At this point, you need to <a class="reference external" href="https://help.github.com/articles/generating-ssh-keys">set up GitHub for SSH access</a>.</p>
<p>When you set up your ssh access, <strong>do not use a key with a passphrase.</strong></p>
<p>Also, <strong>make sure you&#8217;ve been added to the appropriate Zenoss teams</strong>.</p>
</li>
<li><p class="first">Now it&#8217;s time to install zendev:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Path to wherever you keep your source. I like ~/src.</span>
<span class="nv">SRCDIR</span><span class="o">=</span>~/src

<span class="c"># If SRCDIR does not exist, create it</span>
mkdir -p <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>

<span class="c"># Switch to your source directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>

<span class="c"># Clone zendev</span>
git clone git@github.com:zenoss/zendev

<span class="c"># If you get an access denied error cloning the repository, you haven&#39;t</span>
<span class="c"># been added to the appropriate Zenoss teams (see the previous step).</span>

<span class="c"># Enter the zendev directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>/zendev

<span class="c"># Generate egg_info as current user to prevent permission problems</span>
<span class="c"># down the road</span>
python <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>/zendev/setup.py egg_info

<span class="c"># Install zendev in place. This means that changes to zendev source will</span>
<span class="c"># take effect without reinstalling the package.</span>
sudo pip install -e <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>/zendev

<span class="c"># Bootstrap zendev so it can modify the shell environment (i.e., change</span>
<span class="c"># directories, set environment variables)</span>
<span class="nb">echo</span> <span class="s1">&#39;source $(zendev bootstrap)&#39;</span> &gt;&gt; ~/.bashrc

<span class="c"># Source it in the current shell</span>
<span class="nb">source</span> <span class="k">$(</span>zendev bootstrap<span class="k">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Create your zendev environment:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="c"># Get back to source directory</span>
<span class="nb">cd</span> <span class="si">${</span><span class="nv">SRCDIR</span><span class="si">}</span>

<span class="c"># Create the environment for building core devimg</span>
zendev init europa --tag develop

<span class="c"># Start using the environment</span>
zendev use europa

<span class="c"># This may be needed if the above zendev init failed to clone some repos</span>
zendev sync

<span class="c"># Optional: add enterprise zenpacks for building resmgr devimg</span>
zendev add ~/src/europa/build/manifests/zenpacks.commercial.json
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">You can now use zendev to edit source, build Zenoss RPMs, build serviced,</p>
<blockquote>
<div><p>and (if you install <a class="reference external" href="http://www.vagrantup.com/downloads.html">Vagrant</a> and <a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a>) create Vagrant boxes to run
serviced or Resource Manager. As an example, here&#8217;s how you build serviced
and run it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># Ensure you&#39;re in the europa environment (you can also use &quot;zendev ls&quot;</span>
<span class="c"># to check)</span>
zendev use europa

<span class="c"># Go to the serviced source root. cdz is an alias for &quot;zendev cd&quot;,</span>
<span class="c"># automatically set up by the boostrap you sourced in ~/.bashrc.</span>
cdz serviced

<span class="c"># Build serviced (may take a while if it&#39;s the first time)</span>
<span class="c"># The following will build and copy serviced to $GOPATH/bin which</span>
<span class="c"># is already in your search path established by zendev.</span>
make

<span class="c"># Build the Zenoss Docker repo image (also may take a while)</span>
zendev build devimg             <span class="c"># to build core</span>
<span class="c"># -OR-</span>
zendev build --resmgr devimg    <span class="c"># to build resmgr</span>

<span class="c"># Run a totally clean instance of serviced, automatically adding localhost</span>
<span class="c"># as a host, adding the Zenoss template, and deploying an instance of</span>
<span class="c"># Zenoss (warning: blows away state!)</span>
zendev serviced --reset --deploy                                <span class="c"># to deploy core</span>
<span class="c"># -OR-</span>
zendev serviced --reset --deploy --template Zenoss.resmgr.lite  <span class="c"># to deploy resmgr lite</span>
</pre></div>
</div>
<p>If you encounter an error related to permissions while building serviced, you can
resolve the issue by changing the owner of the directory.</p>
<div class="highlight-bash"><div class="highlight"><pre>sudo chown <span class="si">${</span><span class="nv">USER</span><span class="si">}</span> /usr/local/go/pkg/tool/linux_amd64/vet
</pre></div>
</div>
<p>Proceed after seeing the Zenoss template in &#8216;Deployed templates&#8217;.</p>
<p>Example output:</p>
<div class="highlight-bash"><div class="highlight"><pre>Deployed templates:
TemplateID                            Name             Description
639b8be8e7abf1fdce1260d2521f5fd0      Zenoss.core      Zenoss Core
</pre></div>
</div>
<p>When you see this, you should be able to launch Control Center from <a class="reference external" href="https://localhost/">https://localhost/</a></p>
</div></blockquote>
</li>
<li><p class="first">Setting up hosts entries</p>
<blockquote>
<div><p>Log in to Control Center and click on Zenoss.core under the applications list.</p>
<p>You&#8217;ll have multiple Virtual Host Names listed.</p>
<p>Sample output:</p>
<div class="highlight-bash"><div class="highlight"><pre>Virtual Host Name   Service         Endpoint                URL
hbase               HMaster         hbase-masterinfo-1      https://hbase.zenoss-1273
opentsdb            opentsdb        opentsdb-reader         https://opentsdb.zenoss-1273
rabbitmq            RabbitMQ        rabbitmq_admin          https://rabbitmq.zenoss-1273
zenoss5             Zenoss.core     zproxy                  https://zenoss5.zenoss-1273
</pre></div>
</div>
<p>For each of the URLs listed, you&#8217;ll need to add host entries into the /etc/hosts file.
<strong>sudo</strong> edit the file with your choice of editors, and append the host names to the
localhost entry.</p>
<p>Find the public IP of your dev box and replace <strong>&lt;public ip&gt;</strong> below, adding the hosts in
the URL list from CC.</p>
<p>Sample of the first two lines in the /etc/hosts file:</p>
<div class="highlight-bash"><div class="highlight"><pre> 127.0.0.1       localhost
<span class="hll"> &lt;public ip&gt;     zenoss-1273 zenoss5.zenoss-1273 hbase.zenoss-1273 opentsdb.zenoss-1273 rabbitmq.zenoss-1273
</span></pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="os-x">
<h2>OS X<a class="headerlink" href="#os-x" title="Permalink to this headline">¶</a></h2>
<p>OS X doesn&#8217;t support Docker natively (although Docker 0.8 ostensibly <a class="reference external" href="http://docs.docker.io/en/latest/installation/mac/">adds OS
X support, via boot2docker</a>). Even if it did, the default case-insensitive filesystem presents a problem if you&#8217;re doing core Zenoss development (this isn&#8217;t a problem with serviced). You&#8217;ll be running things in an Ubuntu Vagrant box in either case.</p>
<p>That said, zendev can still manage your source locally, which will, for
example, allow you to use an IDE in OS X. zendev mounts the environment&#8217;s
source tree into the Vagrant boxes it creates, so you can modify code directly.
If you don&#8217;t care about this, you should probably just use the <a class="reference internal" href="#vagrant-box">Vagrant
box</a> to save yourself some effort. Otherwise:</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Fire up Disk Utility. Create a partition (mine&#8217;s 50G) formatted with</dt>
<dd><p class="first last">a case-sensitive filesystem. Name it, e.g., &#8220;Source&#8221;.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Perform steps 6-9, above, with <tt class="docutils literal"><span class="pre">/Volumes/Source</span></tt> (if you named your</dt>
<dd><p class="first last">partition &#8220;Source&#8221;) as the value of <tt class="docutils literal"><span class="pre">SRCDIR</span></tt>.</p>
</dd>
</dl>
</li>
<li><p class="first">Create an Ubuntu development box and go to town:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>zendev box create --type ubuntu europa
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="windows">
<h2>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h2>
<p>Forget it, man. This will only end in tears. Use the <a class="reference internal" href="#vagrant-box">Vagrant box</a>.</p>
</div>
<div class="section" id="self-managed-vagrant-box">
<span id="vagrant-box"></span><h2>Self-managed Vagrant box<a class="headerlink" href="#self-managed-vagrant-box" title="Permalink to this headline">¶</a></h2>
<p>Essentially, this is a Vagrant box that has already had steps 1-4 and part of 5 applied.
zendev has the capability to create and manage instances of this box within an
environment, but it&#8217;s also perfectly good just to start up a VM for
development.</p>
<p><strong>Note:</strong> Currently this box has Docker 1.5.0 installed.</p>
<ol class="arabic">
<li><p class="first">Install <a class="reference external" href="http://www.vagrantup.com/downloads.html">Vagrant</a> and <a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> (don&#8217;t use old versions, please).</p>
</li>
<li><p class="first">Make a directory, somewhere, anywhere. <tt class="docutils literal"><span class="pre">cd</span></tt> into it.</p>
</li>
<li><p class="first">Create the box:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>vagrant init ubuntu-14.04-CC-1.x
</pre></div>
</div>
<p>As the pretty words will tell you, a Vagrantfile will have been created in that
directory. Edit it and uncomment or add the following line, setting the URL as shown.</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">box_url</span> <span class="o">=</span> <span class="s2">&quot;http://vagrant.zendev.org/boxes/ubuntu-14.04-CC-1.x.box&quot;</span>
</pre></div>
</div>
<p>You should also probably uncomment either the private or public networking line
so you can actually interact with the things running thereon:</p>
<div class="highlight-ruby"><div class="highlight"><pre><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;public_network&quot;</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Optionally, install any plugins.  For example, the scp plugin, which will
allow you to copy files to the box:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>vagrant plugin install vagrant-scp
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Start the box and log in to it:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>vagrant up
vagrant ssh
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Execute steps 3 and 5-9 from the Ubuntu section above.</p>
<blockquote>
<div><p>Notice in step 5, some of the software is already installed.  <tt class="docutils literal"><span class="pre">dpkg</span> <span class="pre">-l</span></tt> is your friend here.</p>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="update-zendev">
<h2>Update zendev<a class="headerlink" href="#update-zendev" title="Permalink to this headline">¶</a></h2>
<p>Zendev should always be installed from a source checkout, in place. If you want
to update it, you can run:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre>zendev selfupdate
</pre></div>
</div>
</div></blockquote>
</div>
</div>


</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014 Zenoss.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>